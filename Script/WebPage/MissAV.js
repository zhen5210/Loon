// Built at: 2025/7/20 11:45:43
function h(s={}){let e=Object.create(null),t=r=>typeof r=="string"?r.toLowerCase():r;for(let[r,n]of Object.entries(s))e[t(r)]=n;let o={get(r,n){return Reflect.get(r,t(n))},set(r,n,i){return Reflect.set(r,t(n),i)},has(r,n){return Reflect.has(r,t(n))},deleteProperty(r,n){return Reflect.deleteProperty(r,t(n))},ownKeys(r){return Reflect.ownKeys(r)},getOwnPropertyDescriptor(r,n){return Reflect.getOwnPropertyDescriptor(r,t(n))},defineProperty(r,n,i){return Reflect.defineProperty(r,t(n),i)}};return new Proxy(e,o)}function v(s){return typeof s!="object"||s===null?String(s):typeof s.toString=="function"&&s.toString!==Object.prototype.toString?Array.isArray(s)?JSON.stringify(s):s.toString():s instanceof RegExp?s.toString():s instanceof Date?s.toISOString():JSON.stringify(s)}var u=class s{static getInstance(e){let t="Surge";if(typeof $loon<"u")t="Loon";else if(typeof $task<"u")throw new Error("QuantumultX is not supported");return s.instances[t]||(s.instances[t]=s.classNames[t](e,t)),s.instances[t]}static classNames={Surge:(e,t)=>new g(e,t),Loon:(e,t)=>new y(e,t)};static instances={};className;name;logLevels={debug:1,info:2,warn:3,error:4,off:5};logLevel=this.logLevels.error;request;response;argument;_url;get url(){return this._url||(this._url=new URL(this.request.url)),this._url}constructor(e,t){this.className=t??"",this.name=e??"",this.init()}createProxy(e){return new Proxy(e,{get:this.getFn,set:this.setFn})}getFn(e,t,o){return Reflect.get(e,t,o)}setFn(e,t,o,r){return Reflect.set(e,t,o,r),!0}getJSON(e){let t=this.getVal(e);return t?JSON.parse(t):null}setJSON(e,t){this.setVal(JSON.stringify(e),t)}logWithPrefix(e,t){console.log(`${e}${t.map(o=>v(o)).join(" | ")}`)}log(...e){this.logWithPrefix("",e)}debug(...e){this.logLevel>this.logLevels.debug||this.logWithPrefix("[DEBUG]",e)}info(...e){this.logLevel>this.logLevels.info||this.logWithPrefix("[INFO]",e)}warn(...e){this.logLevel>this.logLevels.warn||this.logWithPrefix("[WARN]",e)}error(...e){this.logLevel>this.logLevels.error||this.logWithPrefix("[ERROR]",e)}exit(){$done({})}abort(){$done()}},g=class s extends u{static propertyMap={bodyBytes:"body"};getFn(e,t,o){let r=s.propertyMap[t]||t;return super.getFn(e,r,o)}setFn(e,t,o,r){let n=s.propertyMap[t]||t;return super.setFn(e,n,o,r)}init(){typeof $request=="object"&&(this.request=this.createProxy($request)),typeof $response=="object"&&(this.response=this.createProxy($response)),typeof $argument=="string"&&(this.argument=JSON.parse($argument),"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}getVal(e){return $persistentStore.read(e)}setVal(e,t){return $persistentStore.write(e,t)}fetch(e){let{method:t,body:o,timeout:r=5,...n}=e;return new Promise((i,l)=>{$httpClient[t]({...n,body:o,"binary-mode":o instanceof Uint8Array,timeout:r},(p,c,d)=>{if(p)return l(p);let b=d instanceof Uint8Array?"bodyBytes":"body";i({status:c.status,headers:c.headers,[b]:d})})})}notify(e=this.name,t="",o="",r={}){let{openUrl:n,clipboard:i,mediaUrl:l,dismiss:p,sound:c=!0}=r,d={url:n,text:i,"media-url":l,"auto-dismiss":p,sound:c};n?d.action="open-url":i&&(d.action="clipboard"),$notification.post(e,t,o,d)}ungzip(e){return $utils.ungzip(e)}done(e){$done(e)}abort(){$done({abort:!0})}},y=class extends g{init(){super.init(),typeof $argument=="object"&&(this.argument=$argument,"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}fetch(e){return e.timeout=(e.timeout??5)*1e3,super.fetch(e)}notify(e=this.name,t="",o="",r={}){let{openUrl:n,mediaUrl:i,clipboard:l,delay:p}=r,c={openUrl:n,mediaUrl:i,clipboard:l};$notification.post(e,t,o,c,p)}abort(){$done()}};var f=class{message;domParser=new DOMParser;constructor(e){this.message=this.fromString(e)}fromString(e){return this.domParser.parseFromString(e,"text/html")}toString(){return this.message.documentElement.outerHTML}append(e,...t){return t.map(o=>e.appendChild(o))}remove(...e){return e.map(t=>t.parentElement?.removeChild(t))}};var a=u.getInstance("Missav"),m=class extends f{scriptElementFilter=e=>{let t=e.innerText||"";return!!(e.getAttribute("src")?.includes("tsyndicate.com")||t.includes("TSOutstreamVideo")||t.includes("htmlAds"))};done(){this.process(),a.done({body:this.toString()})}process(){this.removeElement(),this.addElement()}removeElement(){let e=this.message.getElementsByTagName("script");this.remove(...Array.from(e).filter(this.scriptElementFilter))}addElement(){let e=this.message.createElement("script");e.textContent="(function(){'use strict';document.addEventListener('ready',()=>{window.open=()=>{};if(window.player?.pause){const pause=window.player.pause;window.player.pause=()=>{if(document.hasFocus()){pause()}}}})})();";let t=this.message.createElement("style");t.textContent=`.lg\\:block,.lg\\:hidden,a[href*="//bit.ly/"],div[x-init*="#genki-counter'"],div:has(a[href*='go.myavlive.com']),[x-show$="video_details'"]>div>ul,div[style*='width: 300px; height: 250px;'],.relative>div[x-init*='campaignId=under_player'],div[x-show^='recommendItems']~div[class]:has(>div>div.mx-auto>div.flex>a[rel^='sponsored']){display:none!important}`,this.append(this.message.head,e,t)}};try{if(!h(a.response.headers)["content-type"]?.includes("text/html"))throw new Error("Invalid URL");new m(a.response.body).done()}catch(s){a.error(s,a.request.url)}finally{a.exit()}
