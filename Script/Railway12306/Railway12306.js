// Built at: 2025/7/18 22:24:10
function v(r={}){let e=Object.create(null),t=s=>typeof s=="string"?s.toLowerCase():s;for(let[s,n]of Object.entries(r))e[t(s)]=n;let o={get(s,n){return Reflect.get(s,t(n))},set(s,n,i){return Reflect.set(s,t(n),i)},has(s,n){return Reflect.has(s,t(n))},deleteProperty(s,n){return Reflect.deleteProperty(s,t(n))},ownKeys(s){return Reflect.ownKeys(s)},getOwnPropertyDescriptor(s,n){return Reflect.getOwnPropertyDescriptor(s,t(n))},defineProperty(s,n,i){return Reflect.defineProperty(s,t(n),i)}};return new Proxy(e,o)}function R(r){if(typeof r!="object"||r===null)return String(r);if(typeof r.toString=="function"&&r.toString!==Object.prototype.toString||r instanceof RegExp)return r.toString();if(r instanceof Date)return r.toISOString();try{return JSON.stringify(r)}catch{return"[Unserializable Object]"}}var u=class r{static getInstance(e){let t="Surge";return typeof $loon<"u"?t="Loon":typeof $task<"u"&&(t="QuantumultX"),r.instances[t]||(r.instances[t]=r.classNames[t](e,t)),r.instances[t]}static classNames={Surge:(e,t)=>new g(e,t),Loon:(e,t)=>new y(e,t),QuantumultX:(e,t)=>new m(e,t)};static instances={};className;name;logLevels={debug:1,info:2,warn:3,error:4,off:5};logLevel=this.logLevels.error;request;response;argument;_url;get url(){return this._url||(this._url=new URL(this.request.url)),this._url}constructor(e,t){this.className=t??"",this.name=e??"",this.init()}createProxy(e){return new Proxy(e,{get:this.getFn,set:this.setFn})}getFn(e,t,o){return Reflect.get(e,t,o)}setFn(e,t,o,s){return Reflect.set(e,t,o,s),!0}getJSON(e){let t=this.getVal(e);return t?JSON.parse(t):null}setJSON(e,t){this.setVal(JSON.stringify(e),t)}logWithPrefix(e,t){console.log(`${e}${t.map(o=>R(o)).join(" | ")}`)}log(...e){this.logWithPrefix("",e)}debug(...e){this.logLevel>this.logLevels.debug||this.logWithPrefix("[DEBUG]",e)}info(...e){this.logLevel>this.logLevels.info||this.logWithPrefix("[INFO]",e)}warn(...e){this.logLevel>this.logLevels.warn||this.logWithPrefix("[WARN]",e)}error(...e){this.logLevel>this.logLevels.error||this.logWithPrefix("[ERROR]",e)}exit(){$done({})}abort(){$done()}},g=class r extends u{static propertyMap={bodyBytes:"body"};getFn(e,t,o){let s=r.propertyMap[t]||t;return super.getFn(e,s,o)}setFn(e,t,o,s){let n=r.propertyMap[t]||t;return super.setFn(e,n,o,s)}init(){typeof $request=="object"&&(this.request=this.createProxy($request)),typeof $response=="object"&&(this.response=this.createProxy($response)),typeof $argument=="string"&&(this.argument=JSON.parse($argument),"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}getVal(e){return $persistentStore.read(e)}setVal(e,t){return $persistentStore.write(e,t)}fetch(e){let{method:t,body:o,timeout:s=5,...n}=e;return new Promise((i,l)=>{$httpClient[t]({...n,body:o,"binary-mode":o instanceof Uint8Array,timeout:s},(c,p,d)=>{if(c)return l(c);let P=d instanceof Uint8Array?"bodyBytes":"body";i({status:p.status,headers:p.headers,[P]:d})})})}notify(e=this.name,t="",o="",s={}){let{openUrl:n,clipboard:i,mediaUrl:l,dismiss:c,sound:p=!0}=s,d={url:n,text:i,"media-url":l,"auto-dismiss":c,sound:p};n?d.action="open-url":i&&(d.action="clipboard"),$notification.post(e,t,o,d)}ungzip(e){return $utils.ungzip(e)}done(e){$done(e)}abort(){$done({abort:!0})}},y=class extends g{init(){super.init(),typeof $argument=="object"&&(this.argument=$argument,"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}fetch(e){return e.timeout=(e.timeout??5)*1e3,super.fetch(e)}notify(e=this.name,t="",o="",s={}){let{openUrl:n,mediaUrl:i,clipboard:l,delay:c}=s,p={openUrl:n,mediaUrl:i,clipboard:l};$notification.post(e,t,o,p,c)}abort(){$done()}};var m=class extends u{errorMessage="QuantumultX is not supported";init(){this.notify(this.name,"","\u5DF2\u505C\u6B62\u652F\u6301QuantumultX"),this.exit()}notify(e=this.name,t="",o=""){$notify(e,t,o)}getVal(){throw new Error(this.errorMessage)}setVal(){throw new Error(this.errorMessage)}fetch(){throw new Error(this.errorMessage)}ungzip(){throw new Error(this.errorMessage)}done(){throw new Error(this.errorMessage)}};var f=class{message;constructor(e){this.message=this.fromJsonString(e)}fromJsonString(e){return JSON.parse(e)}toJsonString(){return JSON.stringify(this.message)}};var a=u.getInstance("12306");function x(r){return r.endsWith("/getAdList")?new h(a.request.body):r.endsWith("/mgw.htm")?new b:null}var h=class extends f{done(){a.done({response:{body:this.getResponseBody()}})}getResponseBody(){let{placementNo:e}=this.message;switch(e){case"0007":return'{"materialsList":[{"billMaterialsId":"1","filePath":"#","creativeType":1}],"advertParam":{"skipTime":1}}';case"G0054":return'{"code":"00","materialsList":[{}]}';default:return'{"code":"00","message":"0"}'}}},b=class{filterList=["com.cars.otsmobile.newHomePageBussData"];done(){this.isAd()?a.abort():a.exit()}isAd(){let e=v(a.request.headers);return this.filterList.includes(e["operation-type"])}};try{x(a.request.url)?.done()}catch(r){a.error(r,a.request.url)}finally{a.exit()}
